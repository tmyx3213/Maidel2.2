# Maidel 2.2 要件定義書

## 1. プロジェクト概要

### 1.1 プロジェクト名
**Maidel 2.2** - AIエージェント統合デスクトップアプリケーション

### 1.2 目的
- マルチエージェントシステムの学習・実装
- 自然言語でのタスク実行とキャラクター対話の統合
- Google ADK + MCP による階層的エージェント構成の習得

### 1.3 ターゲットプラットフォーム
- **OS**: Windows
- **実行環境**: Electron デスクトップアプリ
- **開発環境**: VS Code + Claude Code

## 2. 機能要件

### 2.1 コア機能（MVP範囲）

#### 2.1.1 キャラクター対話システム
- **UI形式**: ギャルゲー風インターフェース
  - 中央にキャラクター立ち絵（静止画1枚）
  - 画面下部にセリフ表示エリア
  - 会話履歴のスクロール表示
- **対話機能**: 
  - 自然言語での雑談対応
  - タスク依頼の受付・処理

#### 2.1.2 階層的エージェントシステム
マルチエージェント構成による智的タスク処理

**エージェント構成:**
1. **ConversationAgent（会話判定エージェント）**
   - 入力内容の分類（雑談 vs タスク依頼）
   - 出力: `task_type`

2. **PlannerAgent（実行計画エージェント）**
   - タスクの実行計画策定
   - 出力: `execution_plan`

3. **ExecutorAgent（実行エージェント）**
   - 実際のタスク実行
   - MCPツール呼び出し
   - 出力: `result`

#### 2.1.3 実行計画可視化機能
- **リアルタイム表示**: 現在の実行状況をフローチャート形式で表示
- **進捗管理**: 各ステップの状態（完了✅/実行中🔄/待機⏸️）
- **処理内容表示**: 現在実行中の詳細情報

#### 2.1.4 基本タスク実行
- **計算処理**: 四則演算、関数計算等の基本的な数値計算
- **MCP連携**: 計算機能をMCPプロトコルで実装

### 2.2 技術要件

#### 2.2.1 フロントエンド
- **Framework**: React + Electron
- **UI Components**: 
  - キャラクター表示
  - チャット形式会話UI
  - 実行計画可視化コンポーネント

#### 2.2.2 バックエンド
- **AI Framework**: Google ADK (Python)
- **プロトコル**: Model Context Protocol (MCP)
- **通信**: Electron Main Process ↔ ADK Python Process

#### 2.2.3 エージェント間通信
- **方式**: ADK Shared Session State
- **データフロー**: Sequential Agent による状態管理
- **状態キー**: 
  - `task_type`: タスク分類結果
  - `execution_plan`: 実行計画
  - `result`: 処理結果

## 3. 非機能要件

### 3.1 パフォーマンス
- エージェント処理応答時間: 10秒以内
- UI更新頻度: リアルタイム（1秒間隔でポーリング）

### 3.2 可用性
- ローカル実行による高可用性
- セッション内での状態保持（アプリ再起動時はリセット）

### 3.3 拡張性
- 新しいMCPツールの追加容易性
- エージェント階層の拡張可能性

## 4. MVP範囲外（将来実装予定）

### 4.1 データ永続化
- 会話履歴の永続保存
- セッション跨ぎでの記憶保持

### 4.2 高度なタスク処理
- カレンダー操作
- ファイル管理
- API連携

### 4.3 UI/UX拡張
- キャラクターアニメーション
- 表情差分
- 音声対応

### 4.4 セキュリティ機能
- 認証・認可
- データ暗号化

## 5. 制約事項

### 5.1 技術制約
- Windows環境での動作保証
- Python実行環境の事前セットアップ必要
- ローカル実行のみ（クラウド連携なし）

### 5.2 機能制約
- 単一セッション内での動作
- 基本的な計算処理のみ
- シンプルなUI（最小限のデザイン）

## 6. 成功基準

### 6.1 学習目標達成
- [ ] ADKマルチエージェントシステムの理解
- [ ] MCP連携の実装経験
- [ ] エージェント間通信の習得
- [ ] 実行計画管理の実装

### 6.2 機能達成
- [ ] 自然言語でのタスク依頼受付
- [ ] 3階層エージェントによる処理実行
- [ ] 実行計画の可視化表示
- [ ] 基本計算タスクの正常実行

### 6.3 技術達成
- [ ] Electron + React + ADK の統合動作
- [ ] MCPプロトコルによるツール連携
- [ ] リアルタイムUI更新の実装

## 7. 開発スケジュール概要

### Phase 1: 基盤構築
1. 開発環境セットアップ
2. Electron + React 基本構成
3. ADK環境構築

### Phase 2: エージェント実装
1. 基本的なLlmAgent実装
2. MCPツール（計算機能）作成
3. SequentialAgent による階層構築

### Phase 3: UI統合
1. React UI実装
2. 可視化コンポーネント作成
3. エージェント ↔ UI 連携

### Phase 4: テスト・調整
1. 統合テスト
2. パフォーマンス調整
3. ドキュメント整備

---

**作成日**: 2025年9月19日  
**作成者**: クロコ（執事AI）  
**承認者**: マスター  
**バージョン**: 1.0